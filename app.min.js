$(function(){var a,b=(new Date).getTime(),c={map:{lat:-34.397,lng:150.644,zoom:5},inControl:b};window.location.hash?a=new Firebase("https://mapstash.firebaseio.com/").child(window.location.hash.replace("#","")):(a=new Firebase("https://mapstash.firebaseio.com/").push(c),window.location.hash=a.name()),a.once("value",function(d){var e=d.val()||c;window.map=new google.maps.Map(document.getElementById("map"),{zoom:e.map.zoom,center:new google.maps.LatLng(e.map.lat,e.map.lng)});var f,g,h=function(){currentData={lat:map.getCenter().lat(),lng:map.getCenter().lng(),zoom:map.getZoom()},a.set({map:currentData,inControl:b})},i=function(){f=google.maps.event.addListener(map,"center_changed",h),g=google.maps.event.addListener(map,"zoom_changed",h)},j=function(){google.maps.event.removeListener(f),google.maps.event.removeListener(g)};i(),a.on("value",function(a){var c=a.val();c&&c.inControl!==b&&(j(),map.setCenter(new google.maps.LatLng(c.map.lat,c.map.lng)),map.setZoom(c.map.zoom),i())})})});